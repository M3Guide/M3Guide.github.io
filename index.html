<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mutants Stats</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: left;
        }
        th {
            cursor: pointer;
        }
        th.sort-asc::after {
            content: " \25B2";
        }
        th.sort-desc::after {
            content: " \25BC";
        }
        input[type="text"] {
            margin: 10px 0;
            padding: 5px;
            width: 200px;
        }
    </style>
</head>
<body>

<h1>Sortable and Filterable Table</h1>

<input type="text" id="filterInput" placeholder="Filter table...">

<table id="dataTable">
    <thead>
        <tr>
            <!-- Headers will be inserted here dynamically -->
        </tr>
    </thead>
    <tbody>
        <!-- Data rows will be inserted here dynamically -->
    </tbody>
</table>

<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/YOUR_SHEET_ID/pub?output=csv';  // Replace with your published CSV URL

        Papa.parse(csvUrl, {
            download: true,
            header: true,
            complete: function(results) {
                const rows = results.data;
                const table = document.getElementById('dataTable');
                const filterInput = document.getElementById('filterInput');

                // Insert table headers
                const headers = table.querySelector('thead tr');
                const columns = Object.keys(rows[0]);
                columns.forEach((header, index) => {
                    const th = document.createElement('th');
                    th.innerText = header;
                    th.addEventListener('click', () => sortTable(index));
                    headers.appendChild(th);
                });

                // Insert table rows
                const tbody = table.querySelector('tbody');
                rows.forEach(row => {
                    const tr = document.createElement('tr');
                    columns.forEach(column => {
                        const td = document.createElement('td');
                        td.innerText = row[column];
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });

                // Filter functionality
                filterInput.addEventListener('keyup', function () {
                    const filter = filterInput.value.toLowerCase();
                    const trs = tbody.querySelectorAll('tr');
                    trs.forEach(tr => {
                        const cells = Array.from(tr.children);
                        const matches = cells.some(td => td.innerText.toLowerCase().includes(filter));
                        tr.style.display = matches ? '' : 'none';
                    });
                });
            }
        });

        function sortTable(n) {
            const table = document.getElementById('dataTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.rows);
            const asc = !table.querySelectorAll('th')[n].classList.contains('sort-asc');
            rows.sort((a, b) => {
                const aText = a.cells[n].innerText;
                const bText = b.cells[n].innerText;
                return asc ? aText.localeCompare(bText) : bText.localeCompare(aText);
            });
            rows.forEach(row => tbody.appendChild(row));
            table.querySelectorAll('th').forEach(th => th.classList.remove('sort-asc', 'sort-desc'));
            table.querySelectorAll('th')[n].classList.add(asc ? 'sort-asc' : 'sort-desc');
        }
    });
</script>

</body>
</html>
